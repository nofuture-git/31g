Notes Azure
----
Exam AZ-900 Microsoft Azure Fundamentals, Second Edition
Jim Cheshire
----

----
Basic Cloud Concepts 
 - cloud computing: computation as 
   an inter-networked distribution of machines

 - high availability
  - availability is application being accessible to users
  - loss of availability 
   - network outage
   - power outage
   - system outage
    - e.g. VM hosting 
   - application problem
    - e.g. configuration 
   - dependency problem 
    - e.g. database
  - SLA: Service Level Agreement
   - contract for availability by some percentage
   
 - scalability
  - computing is not free so buy only-what-you-need
  - horizontal scaling 
   - "scale out"
   - add more machines
  - vertical scaling
   - "scale up"
   - more powerful machines
  - elasticity: having both horizontal and vertical scaling

 - fault tolerance: provider auto-moves off bad machines
  - small scale problems managed by cloud provider
  
 - disaster recovery
  - BCDR: Business continuity and disaster recovery
  
 - On-Premises Model
  - physical computer hardware
  - network infrastructure
  - physical storage of server racks
  - capital expenses (big-money)
  
 - Cloud Model
  - Rent computing resources 
  - operating expenses 
  - cloud provider exp. economies-of-scale by
    purchasing huge number of machines  
----

----
Kinds of Cloud Services
 - shared responsibility model
 - cloud-pyramid 
  - idea of more control equals more responsibility
  
 - IaaS: infrastructure-as-a-service
  - highest level of control and responsibility
  - control over the VM itself
   - must perform updates
   - manage users thereof
   - actual remote into the VM
   - create Remote Desktop Connection files (RDP)
     for other VM users
  - can shutdown VMs and not be charged
   
 - PaaS: platform-as-a-service
  - mid-level control and responsibility
  - cloud provider handles VMs
  - typical resource is Azure App Service
  - you handle application running therein
  
 - SaaS: software-as-a-service
  - least control and responsibility
  - these are cloud-based web applications
  - common example is Office365
  - paying in subscription-model
  
 - serverless computing
  - idea of borrowing some VM to run a 
    program once
  - typical resources
   - Azure Functions
   - Logic Apps
   - Cognitive Services
----

----
Access of Cloud Computing
 - Public Cloud
  - is shared infrastructure
  - called 'multi-tenant' environments
 
 - Private Cloud
  - is single, dedicated infrastructure
  - called 'single-tenant' environments
  - basically a private network that
    is not on-premises
  
 - Mixed (Hybrid)
  - application is hosted on public cloud
  - uses resources that are hosted on private cloud
  - inter-networking of two clouds is very complex
----

----
Azure Core Architectural Components
 - Geographies: groupings of Regions
  - US Geography's Regions:
    - Central US
    - East US
    - West US
    - South Central US
    - North Central US
    - US Gov Texas

 - Regions
  - specific data-centers spaced across globe
   - are physical buildings
   - cloud provider owns data-centers
   - cloud provider owns fiber-cables connecting them
   
 - Region Pairs
  - Microsoft defined pairings of regions which 
    experience updates in a staggered approach
   - a kind of blue-green deployment of a data-center(?)
  - defined at https://bit.ly/az900-regionpairs
  
 - Availability Zones
  - designed to protect against data-center failures
  - subdivision of a Region
  - are defined by being unique physical locations 
  - at least three in each region
  - exclusive sources of:
   - water source
   - power source
   - infrastructure cables
  - Zonal services: deployed into availability zones explicitly
  - Zone-redundant: Azure deploys to multiple availability zones  
  
 - Resource Groups
  - are arbitrary groupings of Azure resources under a 
    single subscription Id
  - allows tagging so its clear on invoice
  - allows for removal as-a-whole (all resources therein)
  - in Terraform:
   - azurerm_resource_group
 
 - Subscription Management Groups
  - are arbitrary groupings of multiple Azure Subscriptions
  - may contain other Management Groups
 
 - Azure Resource Manager (ARM)
  - all requests are JSON, declarative templates
  - portal to all Azure resources
  - is used by
   - Azure Portal
   - Azure Command Line
   - Visual Studio
 
 - Availability Sets
  - fault tolerance for Azure VMs
  - based on concepts of physical machines 
    stacked on physical racks in a datacenter
   - forms a kind of matrix of rows and columns
  - Fault Domain: a logical representation of 
    a physical rack in which a VM is hosted 
  - Update Domain: logical representation of
    physical machine in which VM is hosted
    
 - Scale Sets
  - rule-based limits on when creation\removal of 
    Azure VMs
---- 

----
Azure Core Resources
 - a manageable item that is available through Azure
 - each instance of a resource will have a URI
  - similar concept to, "what is an object" in OOP

 - Azure Subscription
  - highest level Azure resource
  - is defined by a unique subscription Id
  - is associated to limits-of-resources (quotas)
   - Free Trial
   - Pay-As-You-Go
   - Pay-As-You-Go Dev/Test
    - for devs in Visual Studio

 - Azure Virtual Machines (VMs)
  - most common resource
  - in Terraform
   - azurem_linux_virtual_machine 
   - azurerm_windows_virtual_machine
 
 - Azure App Service
  - is a PaaS
  - choose an OS, and runtime(s) 
   - e.g. Linux, DotNet Core
  - App Service Plan: a logical container of VMs to 
    run the Azure App Service
  - in Terraform:
   - azurerm_app_service
 
 - Azure Container Instances (ACI)
  - don't have to pay for the VM running the instance
  - in Terraform
   - azurerm_container_group
 
 - Azure Kubernetes Service (AKS)
  - PaaS to simplify a Kubernetes cluster
  - in Terraform:
   - azurerm_kubernetes_cluster
 
 - Windows Virtual Desktop (WVD)
  - virtualization of a Windows desktop
  - has many complex dependencies
 
 - Virtual Networks (VNets)
  - software implementation of physical networks
   - NIC(s)
   - IP Addresses
   - Subnets
  - typical setup is three-tier (viz. Web, Biz-Logic, Data)
   - is controlled where each is a subnet
 
 - VPN Gateway
  - intended to solve problem cloud communicating with
    on-premises network
  - billed on amount of time used (hourly)
  - has band-width restrictions
  - allows for three kinds of connections
   - VNet-to-VNet
   - Site-to-Site
   - Point-to-Site
 
 - Virtual Network Peering (VNet Peering)
  - intended to connect one VNet to another
  - is across Microsoft's internal backbone infrastructure
  - is low-latency & high-bandwidth
 
 - ExpressRoute
  - focused on high bandwidth 10Gbps
   - high-end (expensive) version is 100Gbps
  - is dedicated fiber connections
  - connects to a Microsoft Enterprise Edge router (MSEE)
  - connection is through a 3rd party service provider
    who already has the fiber connection
   - on-premises is direct-connected to 3rd party
 
 - Container (blob) storage
  - unstructured storage
  - types of blobs
   - block blobs: typical files, etc.
   - append blobs: e.g. logs
   - page blobs: disk storage
 
 - Disk storage (Azure disks)
  - for when VM's need persistent disk
  - can be either HDD or SSD
 
 - Azure Files
  - uses Managed Server Message Block (SMB) protocol
   - allows for simple file operations on any OS
 
 - Storage tiers
  - depends on:
   - how long to store 
   - how often to access what is stored
  - kinds of Container Storage
   - Hot tier: access a lot
   - Cool tier: 30-day storage
   - Archive tier: 180-day storage
 
 - Cosmos DB
  - NoSQL database
  - can be adapted to the various kinds of NoSQL
   - key-value, column, document, graph, etc.
  - various APIs for the various NoSQL implementations 
   - e.g. MongoDB, Cassandra, GraphQL, SQL
 
 - Azure SQL Database
  - SQL Server in the cloud
  - Microsoft manages the DB server
  - two pay-models
   - Database Transaction Unit (DTU): customer
     doesn't get to specify the CPU and power
   - Virtual Core customer can scale the CPU, memory
     and storage
 
 - Azure Database for MySQL
  - MySQL in the cloud
 
 - Azure Database for PostgreSQL 
  - PostgreSQL in the cloud
 
 - Azure Marketplace
  - part of the Azure portal that allows for
    searching and purchasing "templates" which
    bundle up various resources (e.g. WordPress)
    
 - Azure Functions
  - serverless, trigger-based code execution
   - service bus message enqueued 
   - web request received 
   - file added\modified
   - timer-based
   - api specific like Twitter tweet posted
  - runs on Azure App Service infrastructure
  - multiple runtimes are supported
  
 - Azure Logic Apps
  - the next attempt to program with GUI's 
  - also trigger based like Azure Functions
  
 - Azure DevOps
  - a suite of tools for sprint-management (KANBAN), CI\CD, 
    unit-test, code-repo, binary artifacts
----

----
Azure Management Tools
 - Azure Portal
  - web based gui to manage Azure
  - portal.azure.com
  
 - PowerShell Az module
  - documentation at https://aka.ms/azps
  - install the module
 Install-Module -Name Az -Repository PSGallery
  - login to Azure Account through module
   - tenet Id
    - in the Azure Portal, click on Azure Active Directory
   - subscription id
    - use the global search in Azure portal 
 Connect-AzAccount -Tenant $myTenentId -Subscription $mySubscriptionId
 
 - Azure CLI
  - login is through a browser
  - browser will launch 
 az login
  - find help in common manner
 az --help
 
 - Azure Cloud Shell
  - is a shell through the cloud 
  - also has a builtin text editor 
  
 - Azure Mobile App
  - an app available in the Google & Apple stores
  - the Cloud Shell is available in the mobile app
   - the file-editor is not available

 - Azure Advisor
  - a kind of automated audit that finds various
    issues with performance, security, etc.
    
 - ARM Templates
  - JSON files that are declarative for the resource 
    to create
  - can be created but the structure is still expected
----

----
Azure Security
 - Azure Security Center
  - allows for portal monitoring of security
  - Security Center agents can be installed on-premises 
    to integrate them likewise
  - through audit functionality by comparison of 
    various security best practice
 
 - Key Vault
  - storage of secrets, keys and certificates
  - items within are encrypted with keys unknown to Microsoft
  - Hardware Security Modules (HSM), a separate piece of hardware
    to store encrypted content
   - HSMs are required for Federal Information Processing Standard
     (FIPS 140)
 
 - Azure Sentinel
  - based on security best practices named:
   - Security Orchestration, Automation and Response (SOAR)
   - Security Information and Event Management (SIEM)
  - input is based on Azure Log Analytics
 
 - Azure Dedicated Host
  - VMs run on dedicated hardware isolation
----

----
Azure Network
 - networking exist within a single region 
 - top level entity is Azure Virtual Network (VNet)
 - VNet is divided into subnets
  - e.g. web, biz, db
  - 
 - within each subnet are virtual machines each 
   with their own NIC 
 - external load-balancers exist outside a subnet 
 - internal load-balancers exist within a subnet
 - NSGs are applied to a subnet
 - Virtual Network typically defined with CIDR 10.1.0.0/16
  00001010.00000001.00000000.00000000
  11111111.11111111.00000000.00000000
                   |_________________|
                            |
                    total VNet's possible IPs
                    256 * 256 = 65536 possible IPs
 - each subnet is typically divided as CIDR 10.1.0.0/24
  00001010.00000001.00000000.00000000
  11111111.11111111.11111111.00000000
                             |______|
                                |
                             256 possible IPs per Subnet   
 
 - Azure Routing Tables
  - as within a subnet, between subnets in the same VNet
  - to the internet
  - VNet to VPN  

 - Network Security Groups (NSGs)
  - are used to separate logical layers from 
    one another (e.g. web, biz, data)
  - inbound and outbound rules being based on:
   - IP addresses
   - IP ranges
   - subnet(s)
   - network interface (NIC)
   - service tags: are tags provided by Microsoft
     for other Azure networks or outside Internet
    - intended when the IP addresses are unknown
   
 - Azure Firewall
  - a resource defined outside of Azure Virtual Network
  - is a PaaS offering
  - uses rules to determine what traffic is allowed
   - Network address translation (NAT) rules 
    - a this-to-that address (forward traffic)
    - take precedence
   - Network rules
    - allow traffic on specific IP ranges and ports
   - Application rules
    - ambiguous rules based on some application (e.g. Windows Update)
    
 - Custom Network Routing
 
 - Load Balancing Solutions
 
 - Traffic Manager
 
 - Hybrid Network Connectivity

----

----
Azure Identity Services
 
 - Azure Active Directory 
  - traditional idea of users and roles
  
 - Azure Conditional Access
  - uses a policy to define conditions 
  - only available in premium tier
 
 - Azure MFA
  - traditional multi-factor auth
  - only available in premium tier
  
 - Azure Single Sign-On
  - based on traditional SSO 
   - credentials are transformed into a token
   - token is used to auth with other apps & services
   - token's content provides for the claims 
   
 - Azure Role-Based Access Control (RBAC)
  - IAM is Identity and Access Management
  - idea that a scope and role are applied to 
    a security principal to define the access-control
  - common built-in roles
   - owner, contributor, reader
----
